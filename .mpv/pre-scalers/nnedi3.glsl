// This file is a part of MPDN Extensions.
// https://github.com/zachsaw/MPDN_Extensions
//
// This library is free software; you can redistribute it and/or
// modify it under the terms of the GNU Lesser General Public
// License as published by the Free Software Foundation; either
// version 3.0 of the License, or (at your option) any later version.
// 
// This library is distributed in the hope that it will be useful,
// but WITHOUT ANY WARRANTY; without even the implied warranty of
// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
// Lesser General Public License for more details.
// 
// You should have received a copy of the GNU Lesser General Public
// License along with this library.
// 

// The original kernel was created by SEt:
// http://forum.doom9.org/showthread.php?t=169766

// modifications by madshi (for use in madVR):
// (1) use image objects instead of buffers
// (2) hard coded 8x4 instead of 8x6
// (3) only one kernel for both x and y upscaling
// (4) padding + mirroring built into the main kernel
// (5) flexible image channel handling

// Ported to SM5.0 by Shiandow for use in MPDN
// with further modifications and optimizations by Zach Saw

#define WT 8
#define HT 4

#if pass == 0 || pass == 1

#define nns 32

// {{{ include nn_weights_32.inc
const vec4 weights1[256] = vec4[](vec4(0.09535289608538733,-0.4686433593124093,0.2504389067798911,0.06530051731169806),vec4(0.11965482548475848,-0.34438291884362116,0.05164653860629187,0.04117930733264075),vec4(0.046712533167010406,-0.2970547074764909,0.12307467364371405,0.030862190356856445),vec4(0.12015361391604529,0.03760767780840979,0.020383664003020385,0.1528847240297182),vec4(-0.0061363591194094624,0.1806793888717948,-0.24918841517865076,0.07352533802986727),vec4(0.09099254064858542,0.28351090156138525,-0.5157065013736428,0.21316988818944083),vec4(0.03516823851168738,0.03548103623688803,-0.22923680342137231,0.08802616648972617),vec4(0.05496612989009009,0.2334267073929368,-0.5066214720100106,0.17277213238776312),vec4(0.019898136906704167,-0.1399454867314489,0.14116661792286322,-0.07954573089591577),vec4(-0.008044000886002323,0.03533176129349158,-0.02174470777026727,0.029489358716091374),vec4(0.10317405854948447,-0.21157668734304025,0.1361063474942057,0.03667073493488715),vec4(-0.12654648179523065,0.04544373398312018,-0.2580008303593786,0.1800141704188718),vec4(0.028630744494876126,0.06401230936535285,0.06566878204830573,-0.050411839209118625),vec4(0.030123753302177647,-0.13400370831004693,0.11533140187748359,-0.03308913315049722),vec4(0.0278871262598841,0.026366365902504185,0.02443074231632636,-0.05598943138829782),vec4(0.015567650847515324,-0.1094140114109905,0.09887655621059821,0.004121696405491093),vec4(-0.022805630400398513,-0.19881760998032405,0.045141250655433396,0.11209474580027745),vec4(0.11211870500483201,-0.15798173768780543,-0.004790186121681472,-0.0022774331118853297),vec4(0.23684591876008199,-0.7708646125938685,0.5550384082052915,-0.18243774695656612),vec4(0.04219675140120671,0.23092776612975285,-0.2330335371043475,0.05269681167919771),vec4(-0.11633182427249267,0.6048058279011457,-0.7028569571521075,0.07804968097843812),vec4(-0.05937109066508128,-0.013047664597252151,0.17439779715277837,0.044629939660808304),vec4(0.03565561847426579,0.02405356691815541,0.025351137683173874,-0.031082696452358505),vec4(-0.055547743275383255,-0.035933901726821205,0.18174237088896916,0.03143407480456517),vec4(0.11412941274829791,-0.0023082012157829013,0.09548195061870501,0.012356672265013913),vec4(0.07446411421187804,0.1538979446668236,-0.0923040622692497,0.1753530388850777),vec4(0.09470653144308017,-0.23444588872007444,0.31044578907676623,0.06525345502086566),vec4(0.20223765430637286,-0.9113241547565849,-0.6397698635082634,0.297091310556425),vec4(0.0031222494471876416,0.13343041000553058,-0.2710009926777275,0.10619563778527663),vec4(0.09542484191842959,-0.24585143866352155,0.12137641368099139,0.0862857660431473),vec4(0.012818742372473935,0.07390598563142703,0.01584209857173846,0.056741695680102566),vec4(0.1258888429183571,-0.24338305199853494,0.06730817613788531,0.14662891981788562),vec4(0.11425023881383822,0.03133022395559237,-0.27911612781099393,0.04556260613389895),vec4(0.051941016517957905,0.08491719869562075,-0.15544164570383145,0.05604546872564242),vec4(0.11444086191841052,0.17909418401904986,-0.3493519315343292,0.10674681869932101),vec4(0.19211530295797274,-0.41048068197778775,-0.7982643881659897,0.19822634541560546),vec4(0.11962388625033782,0.07768857089467929,-0.09281939657739713,0.02458228340037749),vec4(0.06305136141963885,0.041093375362834195,0.11253675428815768,0.015541437842330197),vec4(0.062157984652003506,0.036186683752021054,0.05250081030317233,0.05897729454227374),vec4(0.0427994391102402,0.06660622900017188,0.09709375707097934,0.04036403802820132),vec4(-0.017693421974399826,-0.058204493656376144,-0.008614949121692916,0.035301827654620865),vec4(-0.07516501209101989,0.06607788132168935,0.0016543053243367467,-0.04425480140707805),vec4(0.027107224628707627,-0.24228939337990596,0.4418826036308019,-0.1536872900869639),vec4(-0.060105762615421554,0.19762120471932576,0.22101418004967854,-0.06327066319863661),vec4(-0.016335458665707847,0.4287895344350545,-0.4445394493486674,0.041110216468950966),vec4(-0.00003462953827693127,-0.08055251015684917,0.04546583519913838,-0.09972055180332973),vec4(0.031958021983882645,-0.01963803096077754,-0.037874094381550094,-0.01913645787499263),vec4(-0.026056758299091598,-0.0654788140054734,0.006300189361354569,-0.011630482211330673),vec4(-0.10598051751367166,0.23479836975820945,0.09105047380217002,-0.2353034784864576),vec4(-0.019180614672222873,0.05579705333002494,-0.07002693618051126,-0.07511401379815652),vec4(-0.03331064636222436,0.30497091060169623,0.13160349225290702,-0.12182286585084512),vec4(0.09687977825888083,-0.06065595353356912,-0.2685938497852476,-0.0035809728396998253),vec4(0.052512813188513974,0.08818739449270652,0.06212246214636252,0.14458312449642108),vec4(-0.025100508875766536,-0.16084781492463662,-0.05986198986283853,0.023090069942554692),vec4(-0.008172335274139186,0.026037623934826115,-0.028641792185226223,0.06286357884891913),vec4(0.046713141553482274,-0.0820075200717838,-0.07090282643548562,0.007894350044807652),vec4(-0.03871680999509408,0.0645246932435839,-0.13759188557378366,0.01928952132948325),vec4(-0.004604909740010044,-0.05981439555398538,0.016213936560234288,-0.018015520818153163),vec4(0.047298302702984074,0.17462376301773475,-0.052870394833007595,0.05623204802759574),vec4(0.06919710134752677,-0.1137478520940931,-0.0564164688657911,0.015111446093214909),vec4(0.038546297528228024,0.14599637483843253,0.19378970360048697,-0.08989977481178357),vec4(-0.08476155454627587,0.05761761760004447,-0.25593732500783517,0.09895425086506293),vec4(0.00865058397539542,-0.005774462766567012,0.03510762547739432,-0.040332222528377315),vec4(-0.03987561369649484,0.06404148770161555,-0.14510525966397836,0.038269696586212376),vec4(0.0830345217291324,0.43352658191361115,-0.2737140890058072,-0.025040813892701408),vec4(-0.08964438287875964,0.3952618453804462,0.033454960972449044,-0.05650340875945403),vec4(-0.11416731885037734,0.3253205407563655,-0.3492408778365643,0.01874551811852143),vec4(-0.26791434845290496,0.19479489961304353,0.22195774951615022,-0.3029583164570795),vec4(-0.007822933777788421,-0.1824466522630246,-0.09531092008910491,0.001196649685880402),vec4(-0.05513706913552596,0.047714686781546334,0.2516043547693698,-0.16387240698895766),vec4(-0.007008248179772636,-0.03661161771378829,0.0663133029047458,-0.053470731883862754),vec4(-0.017797553151467582,0.03664030210711644,0.25774634519257233,-0.2686505701240094),vec4(0.05842013360597775,-0.11462138889692142,0.11109654308893369,-0.04129028616807773),vec4(0.008908982217690209,-0.04900858102701022,0.06264806987383054,-0.024664807304361602),vec4(0.12391432078220532,-0.32265090493820026,0.386410322800657,-0.02606125472448184),vec4(0.22829593421556638,-0.7986102580871375,-0.569994199260691,0.20352601883132593),vec4(-0.07821702694855048,0.47584534885027097,0.20336003305055783,-0.0060227785106690135),vec4(-0.015563692137220642,0.02537028195001767,0.004409295335790375,0.05563022644855664),vec4(-0.013972032054880401,0.1494740292582719,-0.06524874566457584,0.023877207950135926),vec4(0.01040659548380063,0.07317265012898133,-0.12051789759061649,0.04167785944082425),vec4(0.06427112484016106,0.018964501858135918,-0.2737826082702668,0.022230344653507927),vec4(-0.13165353162548854,0.24425576889552758,-0.10270669794044807,-0.047204938888171455),vec4(0.07074646168985055,0.03844543808736489,-0.5182151321168931,0.15065503382720635),vec4(0.004247280598065117,0.34655896091499017,0.16276714468040154,0.055341918665362755),vec4(0.09072347806431935,-0.19698908662758186,-0.05566939449272468,0.07611679361798451),vec4(0.036081309259316185,-0.07528817391357734,0.21377223992385552,-0.13632371014318778),vec4(-0.011170891284564277,-0.025169645607093116,-0.05547457671127631,0.022288824260613183),vec4(0.12697226071395562,-0.06451030372045352,-0.013217178344348213,-0.03706301486454322),vec4(-0.05779836157671525,0.2881325127709715,-0.29807830432764604,0.2001302929747908),vec4(-0.0008789824169070926,0.25223431905396865,-0.1794315932165773,0.14840426465161727),vec4(0.03763500025161193,0.0916567610729544,-0.37105019966475083,0.20350300689824508),vec4(0.04633733054288314,-0.32877871970049455,-0.13950172642580583,0.10070441261996166),vec4(0.07319064421244548,-0.40807524899355485,0.20288469811566756,0.09385953826495097),vec4(0.1677707301605551,-0.5598409233462007,0.5384846272099821,-0.03409400413147523),vec4(0.0627113225091307,-0.1954920722018869,0.17991047521718428,0.012842790983995656),vec4(0.09514921327718184,-0.560862448237458,0.25225439091809676,0.08608625253327773),vec4(-0.003601149826863548,-0.08776666334233596,0.11066569277681992,-0.05562165489754989),vec4(-0.011576208456972381,-0.004533291965344688,-0.017729298382619163,0.03391103336252854),vec4(0.08813076356091187,-0.21582772693000152,0.16616421827711747,0.030215754002711037),vec4(-0.0696073930557759,-0.002870873719075462,-0.10958005598149612,0.11037150089759962),vec4(0.014625643209001282,0.07377932855524705,-0.03221066406331374,-0.0112792208637984),vec4(0.03528619447388337,-0.0932861428555043,0.07634134480395005,-0.017662056892731925),vec4(0.015369637698313454,0.00283799210228608,0.00451655575670884,-0.03520175179801299),vec4(0.008783652276179055,-0.065474814906338,0.06161598750986741,0.0012136686746089254),vec4(-0.10350792033932521,0.11955966131426976,-0.23785896523258998,0.07594978885390447),vec4(-0.16783559432587936,0.09437838272788213,-0.10517702920697047,0.04077120201327489),vec4(-0.11765269114039256,0.15691197739579366,-0.11719110532067134,0.047850535080215195),vec4(-0.11072467191479518,0.23001106159426854,0.312311545774719,-0.024211642619775375),vec4(-0.08796917757354095,-0.20345245225689723,0.37146098987795995,-0.054173194974282524),vec4(-0.16196902765295818,-0.20732231362126186,0.49495326058604405,-0.18769416882059886),vec4(-0.054581984117248794,-0.11994420660994365,0.18698440568186925,-0.06911402119658305),vec4(-0.12320734484455897,-0.144437943756202,0.37824483291842625,-0.11136218829415157),vec4(0.05365189240910695,-0.15923295094034984,0.07996612118222401,-0.040910593404987594),vec4(0.06839931646027253,-0.10755284799597575,0.09138646052815602,-0.05851415468714549),vec4(0.043953151271125535,-0.23125444276593043,0.1513995908353536,-0.049187488093593856),vec4(0.06634285377003835,0.38076766656377004,0.18757738994099782,-0.03012906509320601),vec4(-0.04254661610684707,0.26801242755391286,-0.3936068184520991,-0.00740547588429763),vec4(-0.051737620666244766,0.3331032328460424,-0.4652892418052943,0.041764409110328415),vec4(-0.043416834607342025,0.13693024294116185,-0.16564548684618785,-0.00696854217312648),vec4(-0.010461337104061386,0.2168453660015075,-0.23265818430445506,-0.023582420482853195),vec4(-0.02433626277706935,0.16673554556109593,-0.006654455497482559,-0.07662880344651057),vec4(-0.03860461822114303,0.1575750418160169,-0.10511742456219508,0.0014726676199643407),vec4(-0.20844010187647655,0.5470234237764089,-0.4810765080001147,0.0009683825228421483),vec4(0.043051020071288804,0.034764841959258774,0.04770745413043187,0.038099291446997086),vec4(0.11465961375870393,-0.5819147668626101,0.360542849466583,0.06313023605980561),vec4(0.08925000654198811,-0.22770853264592006,-0.028299226596573135,0.16599192546345876),vec4(0.0438662924025266,-0.057207218542316696,-0.10846246702931239,0.14423770533539937),vec4(0.04287932889201329,-0.05303851252756431,-0.10014443023464992,0.035677701995155076),vec4(-0.017802749931433937,0.04285862559117959,-0.011056010782340309,-0.01068972533903434),vec4(-0.05788128747008159,0.01701597386636422,0.13179495447911904,-0.14858451968393638),vec4(-0.08773818349800422,0.7894799884561507,-0.6095620591040642,0.06138902419843362),vec4(0.028208161533257226,0.008102620780846337,-0.490460847675422,-0.037112343412445625),vec4(0.17403115408160374,-0.46523306256494834,0.6406619202498405,-0.12689013703129604),vec4(-0.058071327566722175,0.16021674388684914,-0.0013492155667336192,-0.04845067596397712),vec4(-0.004436467945197364,-0.08738909399471595,0.09734391683377908,0.004025774836918572),vec4(-0.007131700574973365,0.03814408631660626,0.010940159500023583,0.06562630349435494),vec4(-0.05167730262837722,0.05611871072687791,0.18798269221224473,-0.009260923772671958),vec4(0.09930905403234647,-0.05513930430970504,0.10617373773493455,0.02060513088144944),vec4(-0.05405850073657348,0.4000787500444858,0.09328132757582352,-0.016144977122166893),vec4(0.1965962488357036,-0.6204391281899007,-0.6861574809845479,0.14375236694831983),vec4(0.06349978299476788,-0.13713933637700393,0.18623201438822434,-0.0013771012272627559),vec4(-0.002017730086663505,0.14182485529818223,-0.21335749438367202,0.05077551940121339),vec4(0.02229212114252732,0.07455394306816743,-0.08141450694165542,0.055053747088095406),vec4(-0.01252739241681411,0.16563981102444814,-0.15701980999074294,0.03396117576994584),vec4(-0.0028983039628656115,-0.33627393672577455,0.4201952235926001,-0.003353400326886913),vec4(0.04744787497111247,-0.1590206755172403,0.13427421619780944,-0.08070418069473817),vec4(-0.04331012646071031,-0.3238935826193483,0.37646775116809295,-0.10643935034386232),vec4(-0.1336826367150934,0.36266699602492736,0.2035133557546942,-0.17674256517420872),vec4(-0.1011485831659229,0.13705298473723815,-0.16345271298996522,-0.008292325012007495),vec4(-0.08164692500940873,0.2140337245691626,-0.1308847052823694,-0.011706849731126567),vec4(-0.021734742618718883,0.04317506571896956,-0.048084078527608654,-0.020302986897149822),vec4(-0.1346325261365564,0.22022966650911258,-0.09281417558304383,0.021962510250887135),vec4(0.030087080613157013,-0.43813452421090915,0.39440923632719205,-0.01775585411451175),vec4(0.05675531441011117,-0.32126696704290225,0.11451831163503812,-0.054751428946474334),vec4(0.023209546521684388,-0.4562686487879546,0.22943924070932553,-0.06909877358339145),vec4(-0.021364185198763153,0.21197256149389432,0.4500137835893838,-0.011991606381343445),vec4(-0.01208851969204261,-0.03666028676889255,-0.02408042846582248,-0.005973172545054695),vec4(-0.08707673399112537,0.23316865862943814,-0.17720616160295322,0.06101718993522809),vec4(-0.049823853358248016,0.0012264445576875005,-0.02429998217485263,-0.0073781415667326655),vec4(-0.15106201468370273,0.19399604836144135,-0.12121990619561984,0.08768777252771542),vec4(-0.056668804198125144,-0.3121087413128407,0.1318451602164714,0.023795365184923867),vec4(0.008068916216871003,-0.1458146285112889,0.02368999907412217,-0.010811255484441062),vec4(-0.03578893205485656,-0.43970512708983733,0.3535014081899135,-0.10918922832570388),vec4(-0.12726436665616347,0.5455245513621776,0.9572422642413585,-0.15908676321487292),vec4(-0.13412975816390826,0.10162784048952744,-0.05727534106335952,-0.06866213230750873),vec4(-0.03407236298880889,0.0409008700553386,-0.1208086173828633,0.05551316478886292),vec4(-0.01981423905453994,-0.05529963335357024,-0.12916447332463576,-0.011042528956750175),vec4(-0.02824820688329055,-0.037979520096996566,-0.23196475318036391,0.08318987378515885),vec4(0.0265170417878835,0.15429038630463765,-0.06910648120901897,-0.09176833106539561),vec4(0.052951983005186776,-0.006958759560802719,-0.11184721364043071,0.0376334272477834),vec4(-0.01952885015271022,0.4711436636898725,-0.8606676824238093,0.12328741775490926),vec4(0.0901118002984731,0.40748966561295674,0.4154540978524892,0.02501564723570482),vec4(0.17736154684462235,-0.7874846972372325,0.29655922280289815,0.026486127466341713),vec4(0.05096218065955327,-0.17544450534842326,-0.09421309007666423,0.04570885078646825),vec4(-0.008252910509327194,-0.08730000181458308,-0.006910166874149581,0.03158760146834538),vec4(-0.03843637479803874,-0.028101426720240852,-0.0353801168348582,-0.011160052552440902),vec4(-0.09253314527086332,0.1745319625515549,0.09025901166387484,-0.19660281034521176),vec4(0.04895139654763625,-0.1206783840279968,0.015644576229533413,-0.04310194047502591),vec4(0.04369816539474414,0.07127215323635028,0.33499084023424075,-0.12621254118494107),vec4(0.08784618584104464,-0.22141006978563382,-0.16590020450166776,-0.02776970184277161),vec4(0.00493027439006255,0.21391036716886447,0.015342440285166958,0.11307250132449553),vec4(-0.03020114841274335,-0.10604006441644742,-0.15849757584146573,0.05568674562164233),vec4(-0.002897951922932407,0.05077840743251727,-0.003541950307408115,0.03215487656780169),vec4(0.011099215425929287,-0.03261807019225671,-0.038326177917042514,0.002162616528949002),vec4(0.09254982957281754,0.4410098482076137,-0.21860337367616012,-0.04854695609174087),vec4(-0.07752709387204959,0.4046805936995952,0.04625305423178361,-0.04158720484338119),vec4(-0.06264432629905059,0.215975365430495,-0.29309447219930007,0.05527007469572709),vec4(-0.23556211700997665,-0.02336880674920394,-0.004126222043851158,-0.26130138273219927),vec4(-0.030137579127767822,-0.062219054609158775,-0.17647644987664535,0.04410361202099011),vec4(-0.0347095813449414,0.07074999699034379,0.2485213864747493,-0.12355484923682525),vec4(-0.00755825749001815,0.012182078153273324,0.08000022062697099,-0.0698174025710614),vec4(0.002435385078570107,0.07018486486413167,0.26104298123755143,-0.2741241615112813),vec4(-0.02628095930776908,0.00014875346460030414,0.15823496395387338,-0.01791599875650718),vec4(0.0025044314716069493,-0.3245883036252053,-0.07500698155126884,-0.002124508082488319),vec4(-0.18460626637897803,0.30940744543113397,0.38817435020246194,-0.16266392654142692),vec4(-0.3316594559546502,-0.5502351123686822,-0.20767213886938407,-0.15807518671135767),vec4(-0.18562248273156,0.06411955767907784,0.5184661548737495,-0.2182097427394183),vec4(0.1519305732253997,0.026679406702896813,0.15246600919999764,-0.030235064386943122),vec4(-0.02957274502477958,-0.00029769277534796856,0.2820968132618873,-0.07136031722984626),vec4(0.0471051436070411,0.17305200250484631,0.3587198656205146,-0.05697858816347434),vec4(0.07300848159138695,-0.17801093664820655,0.03862610849682824,0.005737532108469168),vec4(-0.030113233075098833,-0.047242622644262156,0.14505911263768212,-0.08678978291209205),vec4(0.017410587697668234,-0.32702851650174125,0.3546427080327703,-0.1615042349403666),vec4(-0.007578011423902353,0.15548676642720238,0.12298775109593407,-0.07583092705681338),vec4(-0.14420944993253215,0.4250662365848257,-0.1500533184116648,-0.04849294368978008),vec4(-0.07413170096333488,0.37740222009961144,-0.2723319789474772,-0.08714698609765037),vec4(-0.04211115446742042,0.17480027320925728,-0.12001421657259925,0.028566893368406454),vec4(0.023900363772554556,0.19760830531959073,-0.18249791470225318,-0.10521541145499214),vec4(-0.0413148134794028,-0.07415238319299533,0.09127235116102383,0.010018181816121796),vec4(-0.02687864488325431,-0.09835996030233218,0.02824791969396756,0.009775069371244172),vec4(0.07418290229179547,-0.7082211181368621,0.5806507289562433,-0.045339468106249114),vec4(0.027326551095029572,-0.05179569421670749,0.15639361442663358,0.029906942221714417),vec4(-0.05446342861614539,0.49725708068945096,-0.6028964251127036,0.06258522236385033),vec4(0.01262270362713025,0.07122373284437344,-0.07132071553132846,-0.004341985270002624),vec4(0.027696457520505646,0.10580809862949536,-0.09220546780488803,-0.01060066668651416),vec4(-0.01678282318971469,0.13412884512581513,0.021152165547391633,-0.04157497285268619),vec4(0.01720486657359288,-0.0054682038571627345,0.029116228983184556,-0.026236861183861038),vec4(0.020436017603060463,-0.06702738924286678,0.027179405853530625,0.07102154271342442),vec4(-0.08809042645953014,0.3542603634450643,-0.5336470596339495,0.12641592399813817),vec4(0.036376044914504746,-0.04010118468067958,0.2330772139284818,0.09233710420448915),vec4(0.09803441801705048,-0.7163263104703219,0.2706402398798673,-0.02825086674056365),vec4(0.005774208173534134,0.200417117044708,-0.11062250955365016,0.06288688705899403),vec4(-0.016856982543686172,-0.01861341966650798,-0.03333173616192653,-0.007376215591648361),vec4(0.0010628856871335302,0.10548495763578103,-0.07933117373249843,0.0195549138043134),vec4(-0.13624525855630054,0.28888254572302685,-0.41420582722275867,0.3753953348532377),vec4(0.009286200223868946,0.2701218794718443,-0.09377498220055713,0.1596046607628523),vec4(0.0019699331060110126,0.04270987172276364,-0.42628990899174823,0.32805141021162854),vec4(0.15663688589484082,-0.35038948844521656,-0.18695802281945362,0.13084276154768304),vec4(0.02212677669376717,-0.376212545143062,0.17929314781576977,0.11508120369762764),vec4(0.12412841577679501,-0.5791523833140673,0.5583796720638929,-0.07082217972129001),vec4(0.01491694857031689,-0.2244997773632349,0.19514872838408337,0.038262232734268764),vec4(0.14418854524046765,-0.6946876034453453,0.28681313206107006,0.11139769066721783),vec4(-0.029620566576340934,0.04721226432957337,-0.11401838919482543,0.009976035744330147),vec4(-0.01286160497329547,-0.04978069028220489,0.021052500993391732,-0.021128692835191032),vec4(0.03922173270620988,0.18335951754488633,-0.08430817088446929,0.05880897381939576),vec4(0.0402970526520221,-0.07662359735331847,-0.018411972730973503,0.015465088832570473),vec4(0.023486387744924286,0.1197108242813556,0.15563710668720887,-0.07039542792699649),vec4(-0.06045730522237136,0.036576322108885506,-0.20704759022555663,0.08777037152685807),vec4(0.004163644105574349,-0.006942139178136131,0.013313880950590828,-0.024211929350713035),vec4(-0.01907444855532958,0.04879733996131108,-0.14182595273814513,0.031859434038779),vec4(0.016759536058088997,0.0749756906334369,-0.16409290692172362,-0.06962566932998016),vec4(-0.050231869503477355,-0.0024593110974819865,-0.037367620676377555,-0.0409564759429486),vec4(-0.0766606043871434,0.08929534146227525,-0.06672474107108428,-0.154437312095979),vec4(-0.20963040849528625,1.0456804249588458,0.7598902795616596,-0.3498780646441446),vec4(-0.11947755812070682,0.2047957990471332,-0.22195158264003112,-0.16362954972646548),vec4(-0.06828548124394729,0.1249581489864795,-0.07405049464068725,-0.10490658989510848),vec4(-0.06793025991282775,-0.0003954630192311015,-0.03111107012591674,-0.09387110283932998),vec4(-0.09034247061572387,0.09551253990866826,-0.010305621832230827,-0.14354553183875396),vec4(-0.029653215020516654,-0.0639119978841336,0.03954584041275666,0.03295912483372376),vec4(0.021483440712472657,-0.10993487498126342,0.1215743187967746,0.031822896391531685),vec4(-0.10836102178654983,0.03605189809240983,0.00001644232906983234,-0.0166998442109616),vec4(-0.07281371316275909,0.12541017571129487,0.36055032053627656,-0.1594486602662073),vec4(0.03753104509451077,-0.1506141062673123,0.010727501303335885,-0.10431248246095493),vec4(0.03094667086043046,0.17182428279556916,-0.1512559588845761,-0.010795430451253196),vec4(0.003999150187155465,-0.033223361879208824,0.0018009010855166707,-0.032249243169644615),vec4(-0.02873348554930999,0.08441673295237706,-0.05999805888495757,0.021344712764403084));
const vec4 weights2[256] = vec4[](vec4(-0.26948241736681666,0.4702381357928971,0.007855703719542362,-0.3155198230961105),vec4(-0.0009548369416734204,-0.20715811695845332,0.0012146417429903522,-0.14587463285715785),vec4(-0.13563713278563228,0.20023836348264012,-0.2984129622200271,0.13365738246648107),vec4(0.08233403567282949,-0.01606480903865304,-0.5168098941067001,0.056926095523522235),vec4(0.047372886576340534,0.5360023841640214,0.09517410550324712,-0.09174084510596003),vec4(-0.0775144010403892,0.4497450158378342,-0.014223371967091225,0.0735013351222733),vec4(0.019171395935700275,-0.024289487264468335,0.0291161887726048,-0.1599731132009765),vec4(-0.021657825316651724,-0.11906522359640803,0.010679149665520526,0.20115207288472448),vec4(0.01699261905014282,-0.02555370165646309,-0.010729732202889863,0.07399324120342499),vec4(-0.008547114419343416,0.019175661516783293,-0.020432913886907045,0.03697799683868652),vec4(-0.02051796598971123,-0.08787520623445744,-0.5509756898754858,0.5638896727687097),vec4(0.06813753188907867,-0.3384746706360602,-3.043533811556699,3.362033357632754),vec4(-0.009650161700847093,-0.06056266368977958,-0.4400492703789496,0.3913431072360254),vec4(-0.03398308737814659,0.010649917436239775,-0.0042928627008222975,0.029376176906225737),vec4(0.018652153921721037,-0.0028778745108866133,-0.03781118823826546,0.04850955845176941),vec4(-0.001004984813334886,-0.005298545795085374,0.022326087368128356,0.04011436344444519),vec4(0.12283783078601118,0.06932688177039381,-0.1618827241618419,-0.181758630569675),vec4(-0.05796560786257032,0.08855043769290205,-0.044989263187744655,-0.05120718247781042),vec4(-0.0630047624144936,0.334563393596909,0.682037462000153,-0.4704440045316005),vec4(-0.05976302690396551,-0.5541062164265895,-0.015447984929778613,0.24670301795413252),vec4(-0.04110416166076902,0.11819501638819929,0.009320911471149884,0.128230665330193),vec4(0.006131355170509778,-0.19922202407906298,-0.05617787085066084,0.10594547212531324),vec4(0.0698255938332295,0.01338927865435835,-0.07802100481058005,0.08711161137034651),vec4(-0.0015338841039920226,0.03152356714417692,-0.06117608911881689,-0.015888057198026218),vec4(0.0574308397481218,-0.00476316490676254,-0.39862445869948715,-0.1086886910488829),vec4(0.010284042567946017,0.03814413270447403,-0.7133138565113768,-0.006613188772462308),vec4(0.046885280520655215,0.06423268339131027,-0.49326262751128525,-0.07139703014399856),vec4(0.02427942177746445,1.0535250516841188,0.2833456756779924,-0.012649306445382535),vec4(-0.08101082721259445,0.22303684672806412,-0.0572295127203688,0.0701544793555513),vec4(0.07017103454563767,-0.10174010077025741,0.14531170821283013,0.03659171483013779),vec4(-0.028402724652551115,-0.01081114390399307,-0.07070323207881302,0.002767211408354342),vec4(0.009246564120985568,-0.04846634843852371,0.08326885721180588,-0.010999330668710172),vec4(-0.10388719278853387,0.03100118797738105,0.048648186144419014,-0.06753817934077233),vec4(-0.0367060526041314,0.02578593057114631,-0.1407748943893239,-0.005512945237569511),vec4(-0.10646346944849938,0.4595841841073707,-0.09888357657473534,-0.012656949344091117),vec4(0.10053525131661445,0.4865786508889869,-0.23777881253045052,0.08117670577485114),vec4(0.018170468625612557,-0.03859274822752923,0.07530689996201545,0.024640850839205086),vec4(-0.01405569154303521,0.06602356594521552,-0.07324489194434136,-0.16163716826122254),vec4(0.03861314815003425,-0.11155956971924752,-0.1034438906935975,0.04627419274765998),vec4(-0.07441448408644646,0.057980485376901925,-0.02387278515379876,-0.14929640654008836),vec4(-0.020901232317555696,0.0069336152519099414,0.01294032548321411,0.028335363313090056),vec4(0.05009516392601654,-0.0722075843368657,0.06456103984965011,0.004809469624888152),vec4(-0.044054239348042756,0.06532115180743858,-0.07474484975682572,0.020997584506403655),vec4(-0.011647618666756898,0.34025597636355087,-0.03633186157094315,-0.007446601346600801),vec4(0.09575927880359814,-0.06423215504037216,-0.1454291486297734,-0.00994332815753296),vec4(0.029416584118735045,0.04382668499602005,-0.1938702606712468,0.008127660199534148),vec4(0.024815329059492797,-0.03496283228741959,0.006012067839037627,-0.005343898490536958),vec4(-0.035080715373624116,-0.008827849582303315,-0.013100042298901826,-0.024083077267277986),vec4(0.06625355534924893,0.06759812437667279,0.4575398167289677,-0.5869009891830501),vec4(-0.07156998164282413,0.1045800571955624,0.40738286577834515,-0.35356692469940754),vec4(0.09073983632697491,-0.06788408256397815,0.6821854313529911,-0.6687415043197689),vec4(-0.007927054197352845,-0.12890879309998127,0.19191983842029003,-0.04782197869644733),vec4(0.04901396983041195,0.020515417090791743,-0.7564615408264217,0.7386142810501042),vec4(-0.03221470269636484,-0.19615995384083362,-0.3149177531086025,0.4713744124092045),vec4(-0.016562559067097027,0.0509587501801434,-0.25933177269325824,0.21285029255523114),vec4(-0.06860551483259769,-0.13767782098875614,-0.1768484512649593,0.2805747290767613),vec4(0.05943171586841345,-0.020084169693291187,-0.023851447738707066,0.010404481552541256),vec4(0.027723832987248898,-0.026700054295361042,0.0115633150562644,0.014713644050061703),vec4(0.4699688842520118,-0.4702433357015252,-0.06637406442314386,-0.03050610888749361),vec4(2.962456493638456,-2.539062232710421,-0.31321433279663324,0.05053503718227148),vec4(0.5148705532774329,-0.5520208487287164,-0.10658490378409624,0.006990945897996426),vec4(0.05522003676742315,-0.021749422885477543,0.01136994268745184,-0.03599498514086008),vec4(0.05547583010047674,-0.06038821954280138,-0.020073355175554752,0.03307246323674917),vec4(0.028164020739495754,0.0039730435237288475,-0.0015291878953576088,-0.027557571418583393),vec4(-0.043565838401264045,0.41063499190931907,0.09356586375361076,-0.004701017205661628),vec4(0.07081196197395911,2.012270984436327,0.12753393986349693,-0.02182939163321862),vec4(-0.10664182416076073,0.6989294860613882,-0.03888688123697648,-0.0195350523936213),vec4(0.12430456020956626,-2.275600972388929,-0.7551145579564036,-0.058219100152200554),vec4(0.017821057430410292,-0.38969373962754617,-0.0006275854902924038,0.09403205403214088),vec4(0.010242067706712987,-0.08143771699542413,0.17004894950514426,0.01730452497577062),vec4(-0.03754221535200486,0.048586082841211464,0.03858892173593631,0.019557529791200068),vec4(0.07114451863890281,-0.16890834531659493,-0.047439123307412956,0.024365866753214505),vec4(0.0011881434038514271,0.025748453350388445,-0.017163202850497328,0.015966310413205065),vec4(0.017780318172299303,-0.005891934721148573,-0.018334955660975538,0.03038687190564815),vec4(0.0550350241974229,-0.07417053052631672,0.0036665045336121693,0.003862156780087389),vec4(0.05574795535358135,0.1519513416715199,0.4038199477508897,0.03105334124120418),vec4(-0.10917100378719624,-0.009103865115321241,-0.2785678214713698,0.053567237468087114),vec4(-0.01732544669357594,-0.06852422723022755,-0.07767659494129475,0.035594976754509844),vec4(-0.05370277234760579,0.015761791975819506,-0.06343333491531666,-0.029783249585307203),vec4(-0.05493056842533406,0.001181691201054491,-0.007633880464709364,-0.016898677436984144),vec4(0.002089390007313341,-0.18281391687924042,-0.04417923517758027,0.08285377867287025),vec4(-0.010101087915245444,-0.0390056935721077,0.10350689612096176,-0.05660458334023133),vec4(-0.066443171876017,-0.022135187464300543,-0.2636073572211899,0.0682950796908699),vec4(0.006119284254964441,-0.22682142682606354,0.6883758860058151,-0.07139544613892213),vec4(-0.036308806913439184,-0.3515689713531174,0.5142027395195328,-0.04357234068447724),vec4(-0.12351046927506104,0.010960395855363458,0.11170596204465255,-0.026716400461737067),vec4(-0.10708529182011262,0.004989738983567804,0.011882787046488374,0.04669421672588214),vec4(-0.22281775303417817,0.2473879861063324,0.1428562807268463,-0.14723328180843964),vec4(-0.2483272297831718,-0.013152234867447987,0.3887216666189488,-0.19022077848785557),vec4(0.017969346925383434,-0.16187980459653772,-0.11799483062350191,0.02836788384593092),vec4(-0.15986540229641832,0.06080915717757307,0.18539526252425276,-0.1928027930262033),vec4(-0.001612507418030873,0.5191479542700108,0.7334742167440709,-0.04195987494313158),vec4(-0.06618177206837572,-0.11868532808148302,-0.007473655656212941,-0.12297016443335451),vec4(0.13042732267058454,-0.312149935081834,-0.10122315646731295,0.047380051895743236),vec4(-0.09813815416418947,-0.041043200209969655,0.07269441275275312,-0.06403400810086168),vec4(0.17115717320120893,-0.11346448273980059,-0.29889712543808855,0.1165319898573216),vec4(-0.018511614645831287,-0.01672802015673369,0.027923979912884533,-0.060574940289370716),vec4(0.000019856845028698444,0.0004916872130706906,0.06335804716218263,-0.06889800622593611),vec4(0.036792629514820874,0.02964251593220979,0.26952552155125886,-0.296374908532016),vec4(0.04411635652650148,-0.18850131600629538,2.1440217430936173,-1.9613562886370346),vec4(0.008136832271702588,0.06525274470914155,0.22517892078030854,-0.21268228336703032),vec4(0.016052180086262524,-0.03647272184025496,0.07440339878667146,-0.05834782763849944),vec4(-0.022305591846816242,0.0059453482972458005,0.015805476461537182,-0.0373767678393051),vec4(-0.0013094906462356448,-0.03085625811945647,0.0017198409186676145,-0.01809104427229613),vec4(-0.10802981673987233,0.38937699378220714,-0.09022935151369893,-0.1737500023773464),vec4(-0.019703065019712085,-0.2372793298891338,0.031268816001102095,-0.08013123690398061),vec4(-0.08527278944166028,0.38554799140183604,0.09547880620448268,-0.08174837797196233),vec4(-0.012920810349896783,0.0173552106389252,-0.26464209377081716,0.0019321567633596715),vec4(-0.023979911904461915,0.4466348844835011,0.0013352833011595067,-0.077839028530434),vec4(-0.11199721365483128,0.4866481679746357,-0.23619372069151723,0.028437517143174773),vec4(-0.007517416470363969,-0.09001186161549413,-0.06539161547334515,-0.04186165004284703),vec4(-0.03124654383645975,-0.0969057348302158,-0.03489292084486806,0.08752866417853511),vec4(-0.17534716258887784,0.2330772120585607,0.19860960432197317,-0.21740751079414622),vec4(0.016797422253148397,-0.0014559339651896153,-0.12015672139023081,0.07985331007148488),vec4(-0.10460373125170008,0.10849027224685415,0.06472559162284597,-0.15870800166521803),vec4(-0.19258681516294018,0.9719165999522374,0.8300459820857213,-0.14452811068986193),vec4(-0.09656491241548792,-0.3947023015389277,-0.2827825482854678,0.0000933844676183071),vec4(0.11363683529998525,-0.3506126265892817,-0.18136668269653455,0.05237503238822683),vec4(-0.07386719546411769,0.049423723303334555,0.005052043878094992,-0.06559188029859797),vec4(0.10829211660529836,-0.18769912707284675,-0.18286909320522682,0.09846122451926931),vec4(0.013016722412430681,-0.025034184553078376,-0.014334431602037512,-0.0035770970716839656),vec4(-0.05938455903378781,-0.1539944342657691,0.0330066525057191,-0.04029225812701043),vec4(-0.08888985285011586,0.357254720540368,0.1907403983786935,-0.03190269948390778),vec4(0.054431974203907885,-0.3049709133192664,-0.14290300825086888,0.024043034078204073),vec4(-0.013818466788507067,-0.0020634352549677715,0.6801358827069635,-0.21215335348097142),vec4(-0.033619805923081,0.05484671077283565,-0.09110114046779927,-0.07689896294323262),vec4(-0.025287376702181064,-0.014731115879840218,0.050201266320073046,-0.06248312511888798),vec4(-0.025533008607453667,0.06322432240995113,-0.09181408652511891,-0.006114368079579435),vec4(0.021859977809072006,-0.08994453172635986,-0.04507769789051963,-0.012195657523989212),vec4(0.04605156783509301,-0.07282084743928863,-0.07941815774393035,0.0032886997287278064),vec4(0.04219390679645585,-0.001783974985301029,-0.06832625489187194,-0.019651935952424537),vec4(-0.04304522048187209,0.24168442417430924,0.22993074585247086,-0.07911075423908187),vec4(-0.07774909357976867,0.16866652895259904,0.08037284244346665,-0.16183556388568832),vec4(0.017217535940289963,-0.05507174279046012,-0.0029262602838571183,-0.012740051424771082),vec4(-0.03915084670734359,0.01802935679006623,0.05952190835523652,-0.06035406659793807),vec4(-0.002011651224165689,-0.037139480518817436,-0.00495550344203366,0.03649179865169572),vec4(-0.0094199477462098,-0.2551940529374406,-0.013374619069509208,0.020703546819277108),vec4(-0.021794967236928642,-0.3365933148888871,-0.00866676855366677,-0.04391901183407754),vec4(-0.08493071782868356,-0.24376018333714455,0.007989615318365395,0.008963495609350502),vec4(0.14897108089644462,0.160563446697779,0.43803422164637595,0.11559389915782958),vec4(0.031097289291210473,0.0027985350461676717,0.1337063090177253,-0.050511345150880516),vec4(0.0012290702434256673,0.013766490039415658,0.013384707388468087,-0.05603392410557717),vec4(-0.01753028470557183,-0.040276408079080284,-0.047210141899995506,0.06658147287089378),vec4(0.00034940254408866167,0.039134521153755486,0.008846327778883278,0.017502255854196846),vec4(-0.0605979125975864,0.21986360735900234,0.6982791561604245,-0.014874317872454412),vec4(-0.0682280223845737,0.18386585898406338,1.2794951934338314,0.03219983242161106),vec4(0.0165895137906773,0.11951235569722485,0.48414538688666653,0.10507129020697903),vec4(0.0635487654217286,-1.0529685478686588,-1.8012063961505191,0.07792030907876324),vec4(0.006819511574576609,-0.1358128499268787,-0.22444044165604282,0.016950289529631846),vec4(0.0061054665566189215,0.032918925207923166,0.022009177875588648,-0.044000000882078893),vec4(-0.060380355644156225,0.06893729120201897,0.005692693215678446,0.0184731285989983),vec4(0.10795489959127735,0.022143876922200434,-0.13540743403427768,0.009419749301741831),vec4(0.1412902060255874,-0.2059375946118962,-0.39459810822154395,0.07662664682720788),vec4(-0.03629915087367408,-0.14563136218930595,-0.1767269163101446,-0.12610037295962684),vec4(0.06555275947903283,-0.27609760730410926,-0.3231503483548295,-0.029862162162316963),vec4(-0.14605277820373885,0.6024674955115188,0.9665740910277236,-0.11333505480433814),vec4(0.06686781675671227,-0.046111073781503364,0.10112189085339196,-0.027114298631204292),vec4(-0.14860175966168754,0.27787222297047265,0.050639170716749504,-0.11395577012444846),vec4(0.04247391552780755,-0.20716623446787708,0.03498153717373498,0.029057625244604424),vec4(-0.23327693014289252,0.24678527147625573,0.20932559997891076,-0.16161872676457278),vec4(-0.002902975229517324,-0.010038001386419637,-0.10520205080320011,0.0004098546523891855),vec4(-0.0052151064555800986,0.12609638095091213,-0.1102452146988071,0.018764270545943873),vec4(-0.03629083365012775,0.31950177073667874,-0.04972874551822315,-0.07675013124753605),vec4(-0.01655984476019512,0.5344463717956387,-0.10902159094621311,-0.0037795360367454123),vec4(-0.152994798419968,0.21630585015009274,0.010015523137553828,-0.09259645819474827),vec4(-0.008248401729360921,-0.15914593815614353,-0.008477369246975286,-0.06789212852527271),vec4(-0.019234774557844503,0.03449549300785293,-0.047544451354042394,-0.02381988048364292),vec4(0.040129572113073664,-0.10212597429563175,-0.012754129169479711,-0.07959675222446094),vec4(-0.03141306946054101,-0.02108611771836877,-0.027727058622986078,0.028569021727889776),vec4(8.860137313604355e-6,-0.04774867603555322,0.008973994757980108,-0.014431795570999384),vec4(-0.07298114011064172,-0.04762645671144128,0.05827138712629676,-0.05088081071153283),vec4(-0.09935980150476098,0.3080160110257566,0.34460402419790626,-0.07216901192441583),vec4(-0.0806398899294436,0.062188663985580206,-0.04394786665216088,0.0044375150464475155),vec4(-0.042477062437683344,-0.040328672621399164,-0.055682113859802485,0.03870428493246436),vec4(0.004126796033233404,-0.005875727627426386,-0.037280908320099115,0.023398795630782843),vec4(-0.02787663647904992,-0.04885207721963525,0.011594125535339117,-0.02450858661904931),vec4(-0.11120338413093123,-0.029696874913497595,-0.4368640598950151,0.5847892346682784),vec4(0.045482601493858965,-0.01999311569306883,-0.43106244179580244,0.36013870266106096),vec4(-0.0075800758895638864,-0.23983403715465101,-0.7697109398541215,0.808870631724858),vec4(-0.06750863465640577,0.07419791397478548,0.1324152382912871,0.023116096377634676),vec4(0.040381248563789995,-0.28570304486129317,0.8701576772036788,-0.7799673494992021),vec4(-0.020603343855327694,0.25639514949943987,0.5014934125247237,-0.5771656450924638),vec4(0.022017798841261538,-0.09538151743981871,0.27607156661179033,-0.22133731517169508),vec4(0.05969383147385088,0.16205123391773668,0.19184501794006792,-0.3155055758652452),vec4(0.03168137101602042,-0.2107632708721212,-0.10790881784487283,-0.031002991272544023),vec4(-0.034671186142077204,-1.1056351316146902,-0.12658461453247583,0.0019484470612951554),vec4(0.1051599877901026,-0.37844520332146203,0.04402791438769782,0.0008446435458608903),vec4(-0.04889664789516246,1.427581464035029,0.11577654360007728,0.12060258267592872),vec4(-0.04567353604215896,0.3478898453540751,0.015269425792212132,-0.027131765986268874),vec4(-0.007774815800075885,0.004130230379814748,-0.09757593916583573,-0.022864178659801837),vec4(0.03812915561866248,0.005728026015276555,-0.05631231227744138,-0.0343164204605273),vec4(-0.059475080015545245,0.11475795982551062,0.07805159418057883,-0.056547279375081416),vec4(-0.07044042705092579,0.07641465903725475,0.016904964460991323,0.044632143690250814),vec4(-0.0040168470004573464,0.20268035249318928,-0.1750059729674831,-0.027730316505767405),vec4(-0.09870603738818318,9.327544830739498e-6,-0.12063992081675678,-0.18327558098826557),vec4(-0.4935136443236843,0.8612875932594761,0.6768585437675938,-0.4809172755340114),vec4(-0.14108556567225605,-0.07410544215235859,-0.12544968782458454,-0.009356588707305491),vec4(0.04563914181198925,-0.11439946352038532,0.03618635924067348,-0.029285207972861826),vec4(0.07550356478895992,0.06624852807726711,-0.013265744433738291,0.024319692864082754),vec4(-0.04413202463183552,-0.0693885242799297,0.08058439882006496,0.06744500191416591),vec4(0.06547248177230358,-0.14083352172747254,-0.04908801103010774,0.09658697573468089),vec4(-0.04892119253054261,-0.053957650903612375,0.091193079482764,-0.07513831043615937),vec4(0.04454390285536647,-0.04737809533253312,0.2207962921820581,-0.0035683908499777317),vec4(0.15749379014596343,-1.9323792555369437,-1.2450448372401297,-0.004306452814489603),vec4(0.08447298360988498,1.3878909251652658,0.19730127369984984,0.0637957975268364),vec4(-0.10806472087278962,0.961552610155195,0.18151587760075927,-0.08044963562861085),vec4(0.10148564865812659,-0.049735421780496836,0.05326888198032975,0.01716592675074935),vec4(-0.09581417823210359,0.15172523772343993,0.04931401601061225,0.009103973861783743),vec4(-0.00586184486746788,-0.07351605221629143,-0.059312473982572556,0.02595161274075508),vec4(-0.02051752433180809,-0.04648762568831444,-0.08220108970999718,0.005180049687623978),vec4(-0.046740930527448654,-0.03977369889616966,-0.05199507996439934,0.0018802918493747711),vec4(-0.09987234696745872,0.3439951725304127,0.3517344780266285,-0.08669708296656609),vec4(-0.09353214129805565,0.012894634157419205,0.121785718947649,-0.08835608884692192),vec4(0.006043422967195511,-0.05304136499762535,0.0389605350792408,0.015892256051301956),vec4(-0.024034496396780014,-0.01870296522974968,-0.0018185488879680634,-0.02218170091509819),vec4(0.007542390376329422,-0.032401200383901596,-0.02555207535624504,0.040735770016908646),vec4(-0.03533046354459657,0.019046738399993046,0.0511121113140689,0.0028334857252048096),vec4(0.017523340537081822,0.0003640987033577403,0.027505324809681042,-0.0063269355978263775),vec4(-0.07460134138273133,0.05270449782801734,0.0665070075829135,-0.05380279232667817),vec4(-0.029515132651795284,0.32447247545314895,0.062304511322508915,-0.10869732906030549),vec4(0.05569298531008826,0.007542718789409264,-0.1838599111597432,-0.03051471558319463),vec4(0.04439309577537642,-0.002766244690064923,-0.08145490695642366,0.014130891888271435),vec4(0.01966297033322917,-0.06543824483560456,-0.007664186292458908,-0.0007581097834190587),vec4(-0.03052938763903512,-0.007884072483648197,-0.03793898259209527,-0.008713497192729847),vec4(-0.07173708200571127,0.3995318996894639,0.5512106108653825,-0.003688180149765685),vec4(-0.011616797448368743,0.44167289018514566,0.4216162252414506,-0.007735037506790832),vec4(0.12043011441710405,-0.14969897389528342,-0.33123701930162497,0.15341933697345667),vec4(-0.08072351038572378,-1.3969295632850844,-1.4395615470421035,-0.01373322427389212),vec4(0.05713140286388807,-0.16851708412286825,0.28820167362573557,0.02579782038810663),vec4(-0.1323362004768569,0.6346818196761888,0.5732200133788865,-0.23826134324190207),vec4(0.00023646533372811973,0.29421871781232767,0.17700508117559366,-0.05175449818489142),vec4(-0.08229045689222403,0.09008504144730978,0.05443661261233501,-0.10307520747301169),vec4(-0.06880874885246158,0.04201674507930875,0.007018790114670992,-0.018735825549811125),vec4(-0.04177704406902194,0.050178170669823885,-0.019730329047888517,-0.024212806951254606),vec4(-0.3557359571568668,0.38432931946590543,0.035059884656220675,0.04011328564956784),vec4(-2.188055037986487,2.217469454277307,-0.20371739519760013,0.0579293523915112),vec4(-0.4220172162167728,0.4881979231722653,0.0579271768219769,0.0012827669270336628),vec4(-0.06654542637988925,0.07319265650585294,-0.06131757004186511,0.04041515337303281),vec4(-0.060803316067904234,0.05845680879428983,0.016831785906106234,-0.04417186928912997),vec4(-0.02486170781776309,0.03215818153694272,-0.02084268582984805,0.018755481112748384),vec4(-0.10812898142830818,-0.0025362239648529794,0.08783940808280022,-0.0675371752549836),vec4(-0.014162944393319776,-0.11444424255387275,-0.12225948436753242,0.023803634805517504),vec4(-0.12753968103424995,0.11612838344080956,0.1692513807247451,-0.0330222712327668),vec4(0.01975469128592522,0.04424233571990044,0.33740867500091554,0.018406911058264086),vec4(0.034726841611700365,-0.12238736613289802,0.44393152580960304,-0.13591452105538337),vec4(-0.025320457058114698,-0.12072868807808845,0.004144503040151903,-0.05998878343598335),vec4(0.006762607259588549,-0.08322824700371712,-0.001741634445352247,-0.05536268814103096),vec4(-0.020704494552774122,-0.005674319105310133,0.013342572612600634,-0.09906126721398323),vec4(-0.05991665930196177,0.021392692768131383,0.04486922635987867,-0.10424301684543025),vec4(-0.10236432314559352,-0.013248345858301036,0.005932436281000264,-0.09389179856225383),vec4(-0.008862490809406154,-0.05567991994030308,0.40865477635816205,-0.07184528656944167),vec4(-0.014154306656564586,-0.2965690372948302,0.1719322027201997,0.12897322788194288),vec4(-0.00490657523914706,0.1215014578338014,0.13216913952783216,0.07634092583612073),vec4(-0.08818177790089976,-0.12102227941795718,0.011505518996273167,-0.05556335141591262),vec4(-0.03494870387658011,0.06614840491965879,0.018952001773868687,-0.06198547412350308),vec4(-0.017223405695403926,0.0008266651566373184,0.04214162840798963,-0.04673355216800701));
const vec2 weightsum[32] = vec2[](vec2(-1.1677055358886719,-1.6917200088500977),vec2(0.6186103820800781,0.007031878922134638),vec2(-0.6350212097167969,-0.024726424366235733),vec2(-1.3297538757324219,0.5542569160461426),vec2(-0.4712638854980469,-1.3499699831008911),vec2(1.2785224914550781,-0.0037017001304775476),vec2(0.3870429992675781,-0.003382110269740224),vec2(0.9345588684082031,0.021006539463996887),vec2(-0.3264274597167969,-0.02722100540995598),vec2(0.4240303039550781,0.06231347471475601),vec2(0.5259284973144531,2.0783369541168213),vec2(-1.3407402038574219,-0.6383278965950012),vec2(1.1842231750488281,-0.013021470047533512),vec2(-1.1926383972167969,1.6848688125610352),vec2(0.24672317504882812,0.04080779477953911),vec2(0.23454666137695312,-0.36998480558395386),vec2(0.6224861145019531,-0.4098982810974121),vec2(0.08040237426757812,0.06963082402944565),vec2(-0.4549064636230469,-0.06773613393306732),vec2(-0.11133956909179688,0.011352412402629852),vec2(0.048511505126953125,1.166329264640808),vec2(0.7308540344238281,-0.014241988770663738),vec2(0.3815803527832031,0.03581554442644119),vec2(-0.14136886596679688,-0.12018915265798569),vec2(-1.6589469909667969,-1.2611783742904663),vec2(-0.4059867858886719,-0.017563654109835625),vec2(1.0392036437988281,-0.09123184531927109),vec2(1.3840827941894531,0.5425897240638733),vec2(-2.929485321044922,0.1817043423652649),vec2(1.1728096008300781,-0.021594781428575516),vec2(-0.4125480651855469,0.8317528963088989),vec2(1.2840156555175781,-1.1903033256530762));
// }}}

#elif pass == 2 || pass == 3

#define nns 16

// {{{ include nn_weights_16.inc
const vec4 weights1[128] = vec4[](vec4(-0.033926613434118735,-0.08810038100079964,0.21608027090235282,-0.006525940998358237),vec4(-0.051565117939276206,0.03591548670931388,0.04849176873369743,-0.021573767282347944),vec4(0.017689995662408364,-0.7056648207743592,0.8784101849506669,-0.18392015229062508),vec4(-0.17459059487180184,0.24414061774416496,0.23067886914043356,-0.06694317589597176),vec4(-0.2120649735824145,0.6561258530329042,-0.6392793727953858,0.0062841253439955835),vec4(-0.05421624313191842,-0.04894322882489632,0.0802879856984191,-0.013555444582266318),vec4(-0.03791410456494759,0.04700007309122611,-0.030651874645514,-0.09459338317708443),vec4(-0.035926535530848014,-0.010724462374014365,0.0007890390317015772,0.04878591765566398),vec4(-0.07260012653739523,0.29097551080315043,-0.28655150559814047,0.05083745690910746),vec4(0.003374039855884803,0.045878410068439734,-0.12477427748115133,0.0403698154424319),vec4(-0.05509072569282125,0.7191092369231455,-0.7794048174199588,0.0744453665885203),vec4(0.08188807937233378,0.20836722823707987,-0.15686289480970572,-0.03588974502952169),vec4(0.1132686882830285,-0.27229605455966066,0.3859261271628611,-0.10069535699756216),vec4(0.08700802895157267,-0.13675290373237203,0.0641192791136973,-0.08120754388244222),vec4(0.009813368049549354,-0.03152224448592733,0.03235632154076029,0.012913256612705482),vec4(0.055334500697540534,-0.1526618304577596,0.0797941682013743,-0.06946885612876486),vec4(-0.04141290745781134,0.15205393471671869,-0.08218752107666205,-0.04121460280464362),vec4(-0.004108327246171939,-0.001050787783128726,-0.06538595519111823,0.002270121842343542),vec4(-0.011798518515092837,0.3657730642790966,-0.1238997138951845,-0.05660076699302863),vec4(0.2705812875266247,-0.3792275961403675,-0.2542458151382334,0.09465031065894891),vec4(0.04492781819692482,-0.030861855289799678,0.17158131041480829,-0.011716904855234134),vec4(-0.014715003586275088,0.13315711655570794,0.007870775842206967,-0.086131202793581),vec4(-0.0018556293015308256,-0.04005889854477118,0.018116218232648862,0.027083588027494443),vec4(-0.043374384558660495,0.09119809904052545,0.04780141749336053,-0.13721867165611457),vec4(-0.036388858492387044,0.011721805398451579,-0.03084351056338619,0.021288589303480876),vec4(-0.04220370882273983,-0.03100942009211849,0.10805554754017521,-0.06098595981700328),vec4(-0.20130018823863338,0.5168189562010639,-0.4098861639303095,0.14131058818577458),vec4(-0.06001506679774593,0.0421010411429279,0.0011058805595212107,-0.02878938549281429),vec4(0.20444685310042132,-0.5601777707141764,0.4651023305106037,0.009789020483481181),vec4(0.010383889739500773,0.03783746129749943,-0.05034522646189998,-0.02472783559085201),vec4(0.009438828294264567,-0.056339456970704305,0.005233124558913005,0.01725892788647343),vec4(0.01702375030993153,0.010619387691008342,0.0055670893835895185,-0.04209051960231136),vec4(0.041003842508985144,0.04002888933439408,0.08723245993871842,0.012910206473065955),vec4(0.040963490164472205,-0.012746434056566613,0.1292811228396431,-0.00989778507016581),vec4(-0.05407182439546432,0.345178682959272,-0.09186152494828548,0.05704023376722489),vec4(0.2530701352717415,-0.8909985826848015,-0.8639288152133986,0.19956137672681962),vec4(0.0381463066643164,-0.043347322711156266,0.2810690595271126,-0.038297976696298974),vec4(0.012062479412747962,0.19956739679594193,-0.10235087140779342,0.05758940116186295),vec4(0.017128904020978553,0.04980032578725968,0.04930730596800004,0.04653923646230851),vec4(0.03722108588237916,0.11992155448217545,-0.032569269978807824,0.02544691101331864),vec4(-0.08594460928895842,0.253514511938306,-0.08738730991342436,-0.11156298363664519),vec4(-0.0799033805177487,0.07675294434568514,-0.021901147012499678,-0.10390635019382444),vec4(-0.17416764939287077,0.9620542362882816,-0.7247109557882823,0.06920806920072664),vec4(0.03352515255949129,-0.006529645566729414,0.19561873745089997,-0.04111655199983488),vec4(0.2207774507897966,-0.8186274166599787,0.8151580527975284,-0.019900025372294294),vec4(-0.09572570169427763,0.006909830923291338,0.12935851370832552,-0.13374422634103666),vec4(-0.10085214817979704,-0.11910550439813505,0.0796798304273807,-0.043719457034853804),vec4(-0.07396420234897505,-0.010092960243014204,0.15365461861631502,-0.14334972346284758),vec4(-0.046850429187429654,-0.0006566506725675936,0.006523116220819247,0.039015962471353305),vec4(-0.04711012662471603,-0.039491162906301724,0.13655967890201737,-0.0787421555559149),vec4(-0.22059993566097091,0.51800747095524,-0.3839570724320538,0.17947782455860306),vec4(-0.07644949973644088,0.011074437488900912,-0.05385842527346085,-0.027680979381216275),vec4(0.21953174374914397,-0.5337675505232937,0.48050440727649857,-0.002114028940809476),vec4(0.01625351487575699,0.06002779184757401,-0.07431559384883712,-0.03631259621204208),vec4(0.0070920723575227385,-0.06591172636569809,0.016022278656350863,0.006289525617944491),vec4(0.026781386424886477,0.006185515512811435,0.0026137965816133146,-0.04414259017528366),vec4(0.005997469610633743,0.08682679194873799,-0.27771280150943767,0.12689136523670186),vec4(0.037689676470222366,0.07919745702213277,-0.15014720898204814,0.09130275018299017),vec4(0.019389381594123734,0.18363689441150655,-0.36672354493373405,0.1127025391525649),vec4(-0.015566417985496628,-0.10175091963344585,0.3385644587307297,-0.06876713972621928),vec4(0.06253630501134921,-0.44150059674018394,0.2980655934280776,0.006170814818801773),vec4(0.07596596140331258,-0.38672185879283916,0.23263787288135518,0.023912688679160965),vec4(0.02787124175495137,-0.12346688848072063,0.06081544417804707,0.027404865211906326),vec4(0.01653258312410344,-0.18319270949893962,0.21313171643680562,-0.011693785005149948),vec4(0.04198868394280453,-0.015149103399267005,-0.006266074176778602,-0.019965158697118568),vec4(0.018818868402490807,0.08263976693535824,-0.09760211586569767,0.05154187385244313),vec4(0.1570618283786871,-0.5592415201625727,0.3720461875983574,-0.11299924730872135),vec4(-0.10308985590552311,0.10444064259911556,-0.03193056249608617,-0.0888681876621149),vec4(-0.1746937052029125,0.4855243266412117,-0.4455862510166071,0.006062118414888573),vec4(0.01803169966126461,-0.050210701223363685,0.14667512298012753,0.04051498890305538),vec4(-0.003359185453405189,0.11219988584900875,0.011860979799280358,-0.018524544235219764),vec4(0.015377467576513482,-0.034054236408223915,0.020049406293878747,0.0767066013851263),vec4(-0.03224418339402746,-0.029345311495376336,0.2236058634790652,-0.05574492392213415),vec4(-0.030556477877212274,0.1059792262586825,0.04952045502989222,0.007989614519942734),vec4(0.09958549561827112,-0.9008760827508695,0.9282104612412923,-0.1340361612764127),vec4(-0.0885628241029508,-0.2644699591127164,0.08005861678077508,0.007042072442459357),vec4(-0.1914376840376235,0.6192369849505894,-0.5770634191957242,0.07748988988726069),vec4(-0.05520553168923925,-0.1349912064996488,0.10403462472288538,0.053699485686706794),vec4(-0.01138178286225866,0.09515076103537012,0.002992950108932746,-0.04729861793191503),vec4(0.011488869515346778,-0.024379976364684808,0.027292750504898322,0.08421602073042322),vec4(0.08596175986724575,-0.3660792104582242,0.21197047907310207,0.054822326483304096),vec4(0.08145821172195156,-0.19482785385650914,0.11948144513564785,0.03975308723067883),vec4(0.01884734708266933,-0.32309734743637364,0.16042322184341629,0.11148244220214565),vec4(0.02426821071105678,-0.47245877903503697,-0.14887447065291326,0.1181727059503146),vec4(-0.026727843020012187,-0.01829199228984635,0.18548494655090053,0.013630346240574909),vec4(0.01935789066749294,0.16605126935439785,-0.17858397882980626,0.14183417040305812),vec4(0.058496714415127826,0.024779052319104267,-0.0075461856703213925,0.053056449474865985),vec4(-0.007867044923727917,0.03585925775962551,-0.12083393257660191,0.13999730426269252),vec4(0.02809562926097442,-0.24802962298588227,-0.09361160154537629,0.12076386456294586),vec4(-0.015196714355511176,-0.11572823281483124,0.02763399128718902,-0.01708417779980209),vec4(-0.07578865046696137,-0.0018951034088559027,-0.33078113365070294,0.1447990203361087),vec4(-0.11352870221332978,0.4442091250876956,0.8009104148569577,-0.05114361996845673),vec4(0.030631822030159128,-0.5874777601947017,0.31356814150615264,-0.03548653776840638),vec4(0.0002571905116610651,-0.0768467521210141,0.02935227398677398,0.015707370088534844),vec4(0.004095759437518609,-0.12202293033794831,-0.014667305900616157,0.0037676656703524714),vec4(-0.019847910656494605,-0.0787514483471341,0.002367403552966607,0.03172853236003448),vec4(-0.023616976375592458,0.12610196388243367,-0.08985517107964824,-0.03265619956971477),vec4(-0.007399088974011647,-0.008504337902081716,-0.057862527008069264,-0.0025699434171428948),vec4(-0.009591824646008718,0.3134100369262569,-0.11825991169632744,-0.03458959543229412),vec4(0.18419878995894123,-0.23123032533646892,-0.222840772746963,0.08105223691939045),vec4(0.02617634177124728,-0.019585897485626447,0.13386481321333576,-0.007545641894353139),vec4(-0.020852483148587453,0.09110044754027058,0.034625523452746165,-0.0736596354198582),vec4(0.00023662364958454418,-0.03040877663613628,0.014798753623949779,0.014659487371432078),vec4(-0.034355297024262654,0.06880285656927754,0.054400258426653636,-0.11804372751237224),vec4(0.0686957211474919,-0.08795035171704058,0.19949856114192244,-0.029504421236083544),vec4(0.10615193557543989,-0.022534909727141894,0.06612789344592329,0.053966996769418074),vec4(0.17937195014758345,-0.5187071590443111,0.3919913162718558,-0.11916917848782305),vec4(0.10459500264926191,0.2505753607730412,-0.37638835383029345,0.14741831731600996),vec4(0.000667018048375212,0.5409461994896674,-0.968569460393951,0.1624187947492146),vec4(0.06275936674876448,0.087750074384644,-0.45205366897778276,0.12448396992488142),vec4(0.06204127979083296,0.08490988325877424,-0.16276693630413774,0.0721010835151219),vec4(0.038223554311230146,0.17315903019709822,-0.3234875826855159,0.08327871274752852),vec4(0.042229694974707854,-0.047374980795098054,-0.05731795941562723,-0.09437109743328165),vec4(-0.008866565572930085,-0.028182225572777497,-0.1427817515012748,-0.003168607812654045),vec4(0.18460748876361777,-0.44735004221172403,0.25426207455723215,-0.1262870601293571),vec4(-0.15067656551570963,0.826232595098304,0.3769644677723818,-0.1250518134710319),vec4(-0.16627556275659572,0.5891476270827525,-0.5477717689153678,-0.03689164136619638),vec4(-0.04817597781391214,0.02890299047260214,-0.0349304846403129,-0.047396170246315705),vec4(-0.028092997419548738,0.07418186749248434,-0.07497991834850382,-0.04941909228534769),vec4(-0.015332008051586854,0.010698092830466521,-0.08540053878994058,-0.021132068979454743),vec4(0.05901190285487701,-0.07853779549793671,0.06682270412250091,-0.03498444314197968),vec4(-0.0015467142601437445,0.02771207337184478,-0.02469691987232636,0.010734487108607027),vec4(0.1258558297614627,-0.46715650315479706,0.344141392232018,-0.12286392207340668),vec4(-0.16964713092045258,0.21552475933833648,0.08502866486935545,-0.11364642138676118),vec4(-0.18991057904520403,0.4349532259712987,-0.3520545100708432,-0.029196996047062385),vec4(-0.013189080907864081,0.02316227202220489,0.06361785177989532,0.03899258022113372),vec4(-0.012758943988842475,0.10081457738681365,-0.0005709862251705999,-0.027518991186184394),vec4(0.012684185252624047,-0.02258617038921784,-0.04517034049229096,0.09697994236751128));
const vec4 weights2[128] = vec4[](vec4(-0.00133575879590353,-0.018230009904073086,0.05506009227974573,-0.055206658398674335),vec4(-0.012098569502995815,-0.01818679281132063,0.05956790215714136,-0.02232572816865286),vec4(-0.063173152586387,-0.023110691538022365,0.16337640948040644,-0.1276502945329412),vec4(-0.04676981837110361,0.19187842674000422,0.3125314301942126,-0.07515468735800823),vec4(0.030097316870524082,-0.12282337628857931,0.01001811392052332,-0.00019447886006673798),vec4(0.02024147279007593,-0.09613894120411715,-0.08570988949941238,0.019786383876635227),vec4(-0.002153772940800991,-0.028416369190381374,-0.004197675814793911,0.0029013714884058572),vec4(0.01540252930863062,-0.012702930798695888,-0.0740162835791125,0.008734431037737522),vec4(0.06069910677615553,-0.24164729414042085,-0.08891184476669878,0.09874735923949629),vec4(-0.016918776906095445,-0.00782796589192003,0.03451672347728163,-0.0379108547931537),vec4(0.03209592553321272,-0.23182161746080965,-0.05670031008776277,0.10883940907660872),vec4(-0.12072985840495676,0.37750904413405806,0.3817322120303288,-0.086255794740282),vec4(-0.12224316445644945,0.07916955801192671,0.04764603229705244,-0.10128630546387285),vec4(-0.05718988028820604,0.03512968274299055,0.04521161469165236,-0.0853681027656421),vec4(-0.03073458222206682,0.006330357515253127,-0.018194971955381334,0.0042544916504994035),vec4(-0.10084632632788271,0.13906498404685408,0.08659511955920607,-0.1329539701109752),vec4(0.042825962533243,-0.0007160053355619311,-0.009707064251415431,-0.006591540644876659),vec4(0.019932928611524403,0.006565342773683369,-0.01580849743913859,0.004186670412309468),vec4(0.3388917251722887,-0.31658019579481333,-0.012166467378847301,-0.030873876879923046),vec4(1.7557346030371264,-1.5689539507729933,-0.2492080972297117,0.022483448614366353),vec4(0.28715215169359,-0.2717039183480665,-0.05765102512668818,0.00891117297578603),vec4(0.025284986128099263,0.003545495797879994,0.006256039370782673,0.008868518401868641),vec4(0.029092501034028828,-0.03682389564346522,-0.007326622377149761,0.01040384464431554),vec4(0.024890075554139912,0.016505393316037953,-0.026117925415746868,-0.0013017774326726794),vec4(-0.010937718157947529,-0.012770113949954975,0.04734267904859735,-0.05347213376808213),vec4(0.014316810811578762,-0.03282401100295829,0.035180023456632625,-0.02249164268869208),vec4(-0.01272297040122794,0.014154984201013576,0.26647969200712396,-0.27679125354188727),vec4(0.05336616053682519,-0.06910805794905173,1.3311063559303875,-1.2010719268073444),vec4(0.02019253983598901,-0.03859843262034701,0.21792631461721612,-0.21163403377431678),vec4(0.01319619133573724,-0.022592583154619206,-0.00678458944457816,-0.011260883366048802),vec4(-0.014746305947483052,-0.0009312866677646525,0.02591446652513696,-0.023603291665494908),vec4(0.009215435529768001,-0.002172471438825596,-0.02619877964752959,0.002320832158147823),vec4(0.020403789560077712,-0.2169865907926578,0.12501458657789044,0.001771623472450301),vec4(0.048790071363328025,-0.188707956840517,0.02981979606556706,0.011007810215232894),vec4(0.009241858700988814,-0.23797529356670566,0.11685177890467457,0.0424015449534636),vec4(0.007104689459083602,0.2647272406320553,0.21406880600261502,0.07551296448218636),vec4(-0.02888223694753833,0.06410135628539138,-0.09348916428280063,0.005716586689231917),vec4(0.017031708935974166,0.028715463558910415,-0.2522337378759403,0.10374590216088109),vec4(-0.0043429450888652354,0.010333733836887404,-0.06163522767019458,-0.008857847918989137),vec4(-0.009675407578470185,-0.00087894665193744,-0.18338228182983585,0.09068632518756203),vec4(0.0016304268938256428,0.014182740400428884,-0.044867253353004344,0.000888594935531728),vec4(-0.006296243940596469,-0.01800043364346493,-0.037971816447679885,-0.001222400416736491),vec4(-0.04468373717099894,-0.009012874637846835,0.111251381735201,-0.06301917550445069),vec4(-0.03905883007973898,0.18317273030697834,0.16685250173031818,-0.025253394109313376),vec4(-0.05144901243329514,0.11126185725152027,-0.05210138899565209,-0.034720952578936704),vec4(-0.0013988264399813488,-0.06532062073529232,-0.02265214869112242,0.014971980403061025),vec4(-0.003115464423899539,-0.0023408517736243084,-0.015524579634075053,-0.012718910773401149),vec4(0.00024152691185008734,-0.05623818789899815,-0.007354645480518229,0.009868008593912236),vec4(0.0071998856619757134,-0.0069889148107904475,-0.02716582653738442,0.04262099961124477),vec4(-0.006426195741369156,0.013651140838192077,-0.02247473982788506,0.026562541595922085),vec4(0.023147471121774288,-0.06918197696722928,-0.3897572440437216,0.4155953543850046),vec4(0.010277135170326801,-0.25653230970419827,-1.395489810161962,1.612593890971766),vec4(0.014759835659788223,-0.045018570624961285,-0.24068423932112637,0.2607206421562296),vec4(-0.018347902350797085,0.020154084882960888,0.008748578711674782,0.012213244906888576),vec4(0.01353697093509254,-0.008797079452051548,-0.019588895269407658,0.016953802540228935),vec4(-0.010906572581006913,-0.004609500185324578,0.02150365511261043,0.0017305433175351936),vec4(-0.3224709606729448,0.18236083025112748,0.37776205176487565,-0.14082178240641952),vec4(-0.0878602466545999,-0.08823115890845656,0.033878611866384745,-0.03977325512096286),vec4(-0.058920545037835836,-0.09443288063630462,0.3321265601553023,-0.019665643107146025),vec4(0.1467554741539061,-0.33461072808131576,0.10897170985117555,0.10393163049593568),vec4(-0.08054250245913863,0.04243023553863168,0.15884424978867173,-0.09215879207476974),vec4(0.03148587653413415,-0.07266318937763572,0.04835795471444726,-0.033733522053807974),vec4(-0.05753501271829009,-0.009932646062225103,0.10788741940632463,-0.10697953915223479),vec4(0.12185268336907029,-0.163530049379915,-0.1317304871045053,0.13894765311852098),vec4(0.014594609965570271,-0.014953878591768444,-0.025206227670423687,0.025987493922002614),vec4(0.008834990789182484,0.03499230288434774,-0.04155370302032679,0.007079365779645741),vec4(0.0010351642267778516,-0.09555230743717402,0.09073353477288038,-0.03061972267460078),vec4(0.049053377588279545,0.1364081195788458,0.5196396588580683,0.05440245114732534),vec4(-0.04255763895343989,-0.10977893776725978,-0.12419181771110743,0.04131093912292272),vec4(-0.0070514947874471545,-0.3850101948482916,0.03492816083598882,0.0331698163645342),vec4(-0.005242881248705089,-0.05911759741138667,-0.05185849673580378,-0.008299318025819957),vec4(0.011248688329942524,-0.08681374497245997,0.024449857999570668,-0.00006057030986994505),vec4(-0.025775595331651857,-0.10207151877330034,-0.03903665649340837,0.028274734740989516),vec4(-0.021220435151917627,-0.038542247839359334,-0.0406447892273718,0.015959420477884123),vec4(-0.013603341529233148,-0.052254731530410936,-0.1219053741042444,0.11923432839466841),vec4(-0.07699723797486513,0.1409609366710356,0.17505676043583662,-0.02507831039474695),vec4(-0.14313931273864,0.04075544071747572,0.2447889645154646,-0.10198396327541559),vec4(-0.06580558116183965,0.1379350919778517,-0.01744263874934404,-0.012514960715634516),vec4(-0.03593889413969009,0.03738271189286024,-0.009092124873859575,-0.016027842411858728),vec4(-0.04997546015874832,0.055222821658389876,0.02194578689886839,-0.008465981805784395),vec4(0.0791591084562242,-0.12331282580271363,-0.15235819155350327,0.028140319045633078),vec4(-0.07507479609921575,-0.0408231639303267,0.11597351497039199,-0.08440864318981767),vec4(0.05122143542394042,-0.0739859608002007,0.07051037019118667,-0.04059495823457837),vec4(0.03887182241305709,-0.147691632155329,0.6463732696138322,0.03706814115867019),vec4(0.08870151406154037,-0.10674347216263413,0.1323592788539827,-0.03755939798429608),vec4(-0.19790254766121507,-0.14371434086933732,0.21220442419871688,-0.13129405910149217),vec4(0.021567670162767172,-0.137466745916754,0.04198059951886535,-0.01962645584717393),vec4(-0.24208967620506883,0.11779141193255782,0.2256771600805223,-0.15295317256823182),vec4(-0.014214591443305835,0.0929911682906095,-0.018717867642408237,-0.07730059450841509),vec4(0.045901490055257455,0.05803236612700857,-0.1163766396639403,0.018205509200925007),vec4(-0.003757571190362796,0.10565106445574202,0.01350746551179327,-0.11806617802358232),vec4(-0.04826150959706865,0.417299954831833,-0.048947588860755786,-0.04296647137380205),vec4(-0.02694343528128229,0.1417086111905519,-0.12437749034143053,0.01786794202052988),vec4(0.018428782612318173,-0.08446657037711702,-0.049316735327010974,0.0017932566406670958),vec4(0.002953684568637982,0.006970583141082898,-0.059984394669299945,0.021267543226713315),vec4(-0.007873629539972171,-0.04512871181941591,-0.021231510996585712,-0.05464793121791445),vec4(-0.06308296334464103,0.027614153805188835,0.010612390819005668,-0.017876923200674355),vec4(-0.029016368207521737,0.019953124108724296,0.017542503657750785,-0.006391443428583443),vec4(-0.23946385842282325,0.23035625356715173,-0.04330065113026649,0.026393867912702262),vec4(-1.1854040251346305,1.333178676548414,-0.07762171712238342,0.06463970977347344),vec4(-0.2016083971830085,0.19622013706248254,-0.016041845199652016,0.018027402344159782),vec4(-0.035816438612528145,0.04180689889471978,-0.01875339460093528,-0.011047773179598153),vec4(-0.03377785545308143,0.019401796045713127,0.00033875543158501387,-0.011290930327959359),vec4(-0.021967955050058663,0.011099152150563896,0.006690598907880485,-0.011412881431169808),vec4(-0.03264543996192515,0.07946396782062948,0.0038840712513774633,-0.07777132675983012),vec4(-0.02698098705150187,0.04459110810421407,-0.05096883908845484,-0.0008496700320392847),vec4(-0.012409439543262124,0.023506993195042014,0.03174617304466665,-0.07155801192857325),vec4(-0.040271571138873696,0.23504948033951223,0.11227803840301931,-0.0056261776480823755),vec4(-0.05154531286098063,0.08715693070553243,-0.07000451372005045,0.0026342810597270727),vec4(-0.03864804492332041,-0.06174728856422007,0.012517222901806235,-0.008926024893298745),vec4(-0.004526069620624185,0.018785485764965415,-0.016280880430713296,-0.006883895257487893),vec4(-0.014150148490443826,-0.05747225717641413,-0.011345079401507974,0.00899722590111196),vec4(-0.09884275414515287,0.037816257099621,0.07550174824427813,-0.03220607258845121),vec4(-0.0213285080390051,-0.05746945657301694,0.004563108901493251,-0.0059674299554899335),vec4(-0.15008832432795316,0.08965452655684203,0.1187286589993164,-0.04363992728758603),vec4(-0.0329397163586691,-0.012863195617683232,0.38246516964863986,-0.07878638722468168),vec4(-0.01785948791075498,-0.09732529439497739,0.23908859572838992,-0.0802550456719473),vec4(0.018433370511047542,-0.061491518397815526,-0.012463717837817967,-0.0051326967077329755),vec4(-0.021245493669994175,-0.05638451792765409,0.03014984808396548,-0.04757587530184537),vec4(-0.012106723268516362,-0.04176618077326566,0.0038603850407525897,-0.012523344834335148),vec4(-0.013069302891381085,-0.007903807912953198,0.030071287299506366,0.0005957026733085513),vec4(-0.009474740480072796,-0.033831746433861554,0.02784303470980376,-0.014866546844132245),vec4(0.041756256367079914,0.001818193937651813,-0.03787469968665391,0.0546407651854679),vec4(0.04059090360533446,-0.43241991207469255,-0.7730788748012856,-0.008446932886727154),vec4(0.04481044306885451,0.29232941463124007,0.06827545806299895,-0.012954325531609356),vec4(0.01453369006048888,0.5488887865794823,-0.02012156054843217,-0.02974036440718919),vec4(0.017590931500308216,0.07757634937297553,0.06806114211212844,0.012101664091460407),vec4(-0.02425412938464433,0.08240935474168509,-0.011310697649605572,0.005454263533465564));
const vec2 weightsum[16] = vec2[](vec2(0.11487913131713867,0.14732003211975098),vec2(-0.7649044990539551,0.40085089206695557),vec2(0.3377718925476074,0.04539470374584198),vec2(0.5478625297546387,-0.01633528061211109),vec2(-0.24307680130004883,-0.6132638454437256),vec2(0.14132261276245117,0.18542765080928802),vec2(0.22108030319213867,0.03373832628130913),vec2(-0.6171231269836426,-1.6503524780273438),vec2(0.8943743705749512,0.01612924598157406),vec2(-0.11222505569458008,-0.6770308017730713),vec2(-0.7514843940734863,-1.5771801471710205),vec2(-0.08041810989379883,1.103793978691101),vec2(0.7134127616882324,-0.02657824195921421),vec2(-0.8945355415344238,-0.15137669444084167),vec2(-0.12337923049926758,0.9588810205459595),vec2(0.6164431571960449,-0.04239039495587349));
// }}}
#endif

#define W1(n, wt) weights1[(n) * 8 + (wt)]
#define W2(n, wt) weights2[(n) * 8 + (wt)]
#define WS(n)     weightsum[n]

/* Main code */
float sample(sampler2D tex, int plane, vec2 pos, vec2 tex_size)
{
#if pass == 0 || pass == 2
    if (fract(pos.y * tex_size.y) < 0.5)
        return texture(tex, pos + vec2(0, 0.25) / tex_size)[plane];
#define Get(i, j) (texture(tex, pos + vec2((i) - (WT / 2.0 - 1), (j) - (HT - 1) / 2.0 + 0.25) / tex_size)[plane])
#elif pass == 1 || pass == 3
    if (fract(pos.x * tex_size.x) < 0.5)
        return texture(tex, pos + vec2(0.25, 0) / tex_size)[plane];
#define Get(i, j) (texture(tex, pos + vec2((j) - (HT - 1) / 2.0 + 0.25, (i) - (WT / 2.0 - 1)) / tex_size)[plane])
#endif
    vec4 t[WT];

    float sum = 0;
    float sumsq = 0;
    for (int i = 0; i<WT; i++)
    {
        for (int j = 0; j<HT; j++)
            t[i][j] = Get(i, j);
        vec4 pix = t[i];
        sum += dot(pix, vec4(1.0));
        sumsq += dot(pix, pix);
    }

    vec4 mstd = vec4(0);
    mstd[0] = sum / 32.0;
    mstd[1] = sumsq / 32.0 - mstd[0] * mstd[0];
    mstd[1] = mix(sqrt(mstd[1]), 0.0, mstd[1] <= 1.19209290e-07);
    mstd[2] = mix(0.0, 1.0 / mstd[1], mstd[1] > 0);

    float vsum = 0;
    float wsum = 0;
    for (int n = 0; n<nns; n++)
    {
        vec2 sum = vec2(0);
        for (int i = 0; i<WT; i++)
        {
            vec4 pix = t[i];
            sum[0] += dot(pix, W1(n, i));
            sum[1] += dot(pix, W2(n, i));
        }
        sum[0] = sum[0]*mstd[2] + WS(n)[0];
        sum[1] = sum[1]*mstd[2] + WS(n)[1];
        sum[0] = exp(sum[0]);
        vsum += sum[0]*(sum[1]/(1+abs(sum[1])));
        wsum += sum[0];
    }

    float color = clamp(mstd[0] + (5*vsum/wsum)*mstd[1], 0, 1);

    return color;
}
